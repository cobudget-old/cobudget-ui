_ = require('lodash')

module.exports = ($scope, AuthService, AllocationsStore, group, round, memberships) ->
  contributors = round.getContributors(memberships)
  allocations = round.getAllocationsByUser()

  $scope.contributors = contributors
  $scope.isAdmin = group.isAdmin(AuthService.getCurrentUser())

  $scope.updateAllocation = (id, data) ->
    allocation = allocations[id]
    allocation.amountCents = data * 100

    console.log(allocation, data)
    allocation.save(AllocationsStore)
